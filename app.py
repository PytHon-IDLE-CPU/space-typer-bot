import asyncio
import os
import json
import logging
import random
from aiogram import Bot, Dispatcher, types, F
from aiogram.filters import Command
from aiogram.utils.keyboard import ReplyKeyboardBuilder, InlineKeyboardBuilder

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ (—Ç–æ–∫–µ–Ω –±–µ—Ä–µ—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö Railway)
TOKEN = os.getenv("BOT_TOKEN")
ADMIN_ID = 123456789  # !!! –ó–ê–ú–ï–ù–ò –≠–¢–û –ù–ê –°–í–û–ô ID !!!

bot = Bot(token=TOKEN)
dp = Dispatcher()

# –ü—É—Ç—å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
DB_PATH = "players.json"

def load_data():
    if os.path.exists(DB_PATH):
        with open(DB_PATH, "r", encoding="utf-8") as f:
            return json.load(f)
    return {"players": {}, "suggestions": []}

def save_data(data):
    with open(DB_PATH, "w", encoding="utf-8") as f:
        json.dump(data, f, ensure_ascii=False, indent=4)

# –¢–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–≥–æ—Ç–æ–≤–∫–∏ (–Ω–∞—à–∏ "–Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã–µ" –æ–ø–∏—Å–∞–Ω–∏—è)
SPACE_PHRASES = [
    # --- –≠–í–û–õ–Æ–¶–ò–Ø –ò –ñ–ò–ó–ù–¨ ---
    "‚ú® –í–∞—à–∞ —Ç—É–º–∞–Ω–Ω–æ—Å—Ç—å –Ω–∞—á–∞–ª–∞ —Å–≤–µ—Ç–∏—Ç—å—Å—è –ª–∞–∑—É—Ä–Ω—ã–º —Å–≤–µ—Ç–æ–º, —Ä–æ–∂–¥–∞—è –ø–µ—Ä–≤—É—é –∑–≤–µ–∑–¥—É.",
    "üß¨ –í –ø–µ—Ä–≤–∏—á–Ω–æ–º –æ–∫–µ–∞–Ω–µ –æ–¥–Ω–æ–π –∏–∑ –ø–ª–∞–Ω–µ—Ç –∑–∞—Ä–æ–¥–∏–ª–∏—Å—å –ø–µ—Ä–≤—ã–µ –∞–º–∏–Ω–æ–∫–∏—Å–ª–æ—Ç—ã.",
    "üåø –ó–µ–ª–µ–Ω—ã–π –ø–æ–∫—Ä–æ–≤ –æ–∫—É—Ç–∞–ª –º–∞—Ç–µ—Ä–∏–∫–∏. –ö–∏—Å–ª–æ—Ä–æ–¥ –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ –¥–æ—Å—Ç–∏–≥ –Ω–æ—Ä–º—ã.",
    "üêæ –ù–∞ —Å—É—à—É –≤—ã–±—Ä–∞–ª–∏—Å—å –ø–µ—Ä–≤—ã–µ –º–Ω–æ–≥–æ–∫–ª–µ—Ç–æ—á–Ω—ã–µ —Å—É—â–µ—Å—Ç–≤–∞. –≠–≤–æ–ª—é—Ü–∏—è —É—Å–∫–æ—Ä–∏–ª–∞—Å—å!",
    "üß† –û–¥–Ω–∞ –∏–∑ —Ä–∞—Å –Ω–∞—É—á–∏–ª–∞—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–≥–æ–Ω—å. –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, —ç—Ç–æ —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏—è.",
    "üß¨ –í—ã –ø—Ä–æ–≤–µ–ª–∏ –≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç, —Å–æ–∑–¥–∞–≤ —Å—É—â–µ—Å—Ç–≤ —Å –∫—Ä–µ–º–Ω–∏–µ–≤–æ–π —Ñ–æ—Ä–º–æ–π –∂–∏–∑–Ω–∏.",
    "üçÑ –°–ø–æ—Ä—ã –≥–∏–≥–∞–Ω—Ç—Å–∫–∏—Ö –≥—Ä–∏–±–æ–≤ –∑–∞—Ö–≤–∞—Ç–∏–ª–∏ —Ü–µ–ª—É—é –ª—É–Ω—É, –ø—Ä–µ–≤—Ä–∞—Ç–∏–≤ –µ—ë –≤ –µ–¥–∏–Ω—ã–π —Ä–∞–∑—É–º.",
    "üêã –í –Ω–µ–¥—Ä–∞—Ö –≥–∞–∑–æ–≤–æ–≥–æ –≥–∏–≥–∞–Ω—Ç–∞ –∑–∞—Ä–æ–¥–∏–ª–∏—Å—å –ª–µ–≤–∏–∞—Ñ–∞–Ω—ã, –ø–∏—Ç–∞—é—â–∏–µ—Å—è —Ä–∞–¥–∏–∞—Ü–∏–µ–π.",
    
    # --- –ö–ê–¢–ê–°–¢–†–û–§–´ –ò –°–û–ë–´–¢–ò–Ø ---
    "‚òÑÔ∏è –ú–µ—Ç–µ–æ—Ä–∏—Ç–Ω—ã–π –ø–æ—Ç–æ–∫ –ø—Ä–∏–Ω–µ—Å —Ä–µ–¥–∫–∏–µ –∏–∑–æ—Ç–æ–ø—ã. –†–µ—Å—É—Ä—Å—ã —Å–∏—Å—Ç–µ–º—ã +20%.",
    "‚òÄÔ∏è –ó–≤–µ–∑–¥–∞ –ø–µ—Ä–µ—à–ª–∞ –≤ —Å—Ç–∞–¥–∏—é –∫—Ä–∞—Å–Ω–æ–≥–æ –≥–∏–≥–∞–Ω—Ç–∞. –û—Ä–±–∏—Ç—ã –ø–ª–∞–Ω–µ—Ç —Å–º–µ—Å—Ç–∏–ª–∏—Å—å.",
    "üï≥ –†—è–¥–æ–º –æ—Ç–∫—Ä—ã–ª–∞—Å—å –º–∏–∫—Ä–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–∞—è —á–µ—Ä–Ω–∞—è –¥—ã—Ä–∞, –∏—Å–∫–∞–∑–∏–≤ –≤—Ä–µ–º—è –Ω–∞ —Å—Ç–æ–ª–µ—Ç–∏—è.",
    "üí• –°–≤–µ—Ä—Ö–Ω–æ–≤–∞—è –≤—Å–ø—ã—Ö–Ω—É–ª–∞ –≤ —Å–æ—Å–µ–¥–Ω–µ–º —Å–µ–∫—Ç–æ—Ä–µ, –æ–∑–∞—Ä–∏–≤ –≤–∞—à–∏ –º–∏—Ä—ã –Ω–∞ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏—è.",
    "üå™ –ì–∏–≥–∞–Ω—Ç—Å–∫–∏–π –∏–æ–Ω–Ω—ã–π —à—Ç–æ—Ä–º –≤—ã–≤–µ–ª –∏–∑ —Å—Ç—Ä–æ—è –≤—Å–µ —Å–ø—É—Ç–Ω–∏–∫–∏ —Å–≤—è–∑–∏ –≤ —Å–∏—Å—Ç–µ–º–µ.",
    "üßä –õ–µ–¥–Ω–∏–∫–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥ —Å–∫–æ–≤–∞–ª –æ–∫–µ–∞–Ω—ã, –∑–∞—Å—Ç–∞–≤–∏–≤ –∂–∏–∑–Ω—å —É–π—Ç–∏ –≥–ª—É–±–æ–∫–æ –ø–æ–¥ –∑–µ–º–ª—é.",
    "üåã –ì–ª–æ–±–∞–ª—å–Ω–æ–µ –∏–∑–≤–µ—Ä–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–ª–æ –Ω–æ–≤—ã–µ –≥–æ—Ä—ã, –±–æ–≥–∞—Ç—ã–µ —Ä–µ–¥–∫–∏–º–∏ –∫—Ä–∏—Å—Ç–∞–ª–ª–∞–º–∏.",

    # --- –¢–ï–•–ù–û–õ–û–ì–ò–ò –ò –ú–ê–ì–ò–Ø ---
    "üõ∞ –ö–≤–∞–Ω—Ç–æ–≤—ã–π —Å–∫–∞—á–æ–∫ –ø–æ–∑–≤–æ–ª–∏–ª –≤–∞–º –∑–∞–≥–ª—è–Ω—É—Ç—å –≤ —Å–æ—Å–µ–¥–Ω—é—é —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å.",
    "üì° –î—Ä–µ–≤–Ω–∏–π –º–∞—è–∫ –∏—Å—á–µ–∑–Ω—É–≤—à–µ–π —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–∏ –≤–Ω–µ–∑–∞–ø–Ω–æ –Ω–∞—á–∞–ª –ø–æ–¥–∞–≤–∞—Ç—å —Å–∏–≥–Ω–∞–ª—ã.",
    "üí† –í—ã –ø–æ—Å—Ç—Ä–æ–∏–ª–∏ –°—Ñ–µ—Ä—É –î–∞–π—Å–æ–Ω–∞, –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥—á–∏–Ω–∏–≤ —Å–µ–±–µ —ç–Ω–µ—Ä–≥–∏—é –∑–≤–µ–∑–¥—ã.",
    "üõ∏ –ù–µ–æ–ø–æ–∑–Ω–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –≤–æ—à–µ–ª –≤ —Å–∏—Å—Ç–µ–º—É –∏ –æ—Å—Ç–∞–≤–∏–ª –∫–∞–ø—Å—É–ª—É —Å —á–µ—Ä—Ç–µ–∂–∞–º–∏.",
    "üåÄ –û—Ç–∫—Ä—ã—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —á–µ—Ä–≤–æ—Ç–æ—á–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –≤ —Ç—É–º–∞–Ω–Ω–æ—Å—Ç—å –ê–Ω–¥—Ä–æ–º–µ–¥—ã.",
    "ü¶æ –¶–∏–≤–∏–ª–∏–∑–∞—Ü–∏—è –∑–∞–º–µ–Ω–∏–ª–∞ —Å–≤–æ–∏ —Ç–µ–ª–∞ –Ω–∞ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏, –¥–æ—Å—Ç–∏–≥–Ω—É–≤ –±–µ—Å—Å–º–µ—Ä—Ç–∏—è.",
    "üíé –ù–∞–π–¥–µ–Ω –∫—Ä–∏—Å—Ç–∞–ª–ª '–°–µ—Ä–¥—Ü–µ –ó–≤–µ–∑–¥—ã', —Å–ø–æ—Å–æ–±–Ω—ã–π –º–µ–Ω—è—Ç—å –∑–∞–∫–æ–Ω—ã —Ñ–∏–∑–∏–∫–∏.",

    # --- –í–ï–õ–ò–ö–ò–ï –û–¢–ö–†–´–¢–ò–Ø ---
    "ü™ê –ö–æ–ª—å—Ü–∞ –≤–∞—à–µ–π –ø–ª–∞–Ω–µ—Ç—ã —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å, —Å–æ–∑–¥–∞–≤ –∏–¥–µ–∞–ª—å–Ω—ã–π —â–∏—Ç.",
    "üêö –ù–∞ –¥–Ω–µ –æ–∫–µ–∞–Ω–∞ –Ω–∞–π–¥–µ–Ω—ã –≥–æ—Ä–æ–¥–∞, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–æ —Ä–æ–∂–¥–µ–Ω–∏—è –≤–∞—à–µ–π –∑–≤–µ–∑–¥—ã.",
    "üìú –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω –∫–æ–¥ –í—Å–µ–ª–µ–Ω–Ω–æ–π. –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –º–µ–Ω—è—Ç—å —Ü–≤–µ—Ç —Ç—É–º–∞–Ω–Ω–æ—Å—Ç–µ–π.",
    "üßò –ù–∞–π–¥–µ–Ω–∞ —Ä–∞—Å–∞ —Å—É—â–µ—Å—Ç–≤, —Å–æ—Å—Ç–æ—è—â–∏—Ö –∏–∑ —á–∏—Å—Ç–æ–≥–æ —Å–≤–µ—Ç–∞ –∏ —á–∏—Å—Ç–æ–π –º—ã—Å–ª–∏.",
    "üéº –ó–≤–µ–∑–¥—ã –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã –≤—ã—Å—Ç—Ä–æ–∏–ª–∏—Å—å –≤ —Ä—è–¥, –∏–∑–¥–∞–≤ –≥–∞—Ä–º–æ–Ω–∏—á–Ω—ã–π —Ä–µ–∑–æ–Ω–∞–Ω—Å.",
    "üö™ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –¥–≤–µ—Ä—å –≤ '–ü—É—Å—Ç–æ—Ç—É –º–µ–∂–¥—É –º–∏—Ä–∞–º–∏'. –¢—É–¥–∞ –ª—É—á—à–µ –Ω–µ –∑–∞–≥–ª—è–¥—ã–≤–∞—Ç—å.",
    "üçè –ü–ª–∞–Ω–µ—Ç–∞-—Å–∞–¥ —Ä–∞—Å—Ü–≤–µ–ª–∞ –º–∏–ª–ª–∏–æ–Ω–∞–º–∏ –æ—Ç—Ç–µ–Ω–∫–æ–≤, —Å—Ç–∞–≤ –∂–µ–º—á—É–∂–∏–Ω–æ–π —Å–µ–∫—Ç–æ—Ä–∞.",
    
    # --- –°–¢–†–ê–ù–ù–û–°–¢–ò ---
    "üß© –í—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏, —á—Ç–æ –æ–¥–Ω–∞ –∏–∑ –ø–ª–∞–Ω–µ—Ç –∏–º–µ–µ—Ç –∏–¥–µ–∞–ª—å–Ω—É—é —Ñ–æ—Ä–º—É –∫—É–±–∞.",
    "üï∞ –ù–∞ —Å–ø—É—Ç–Ω–∏–∫–µ –≤—Ä–µ–º—è —Ç–µ—á–µ—Ç –≤—Å–ø—è—Ç—å. –í—á–µ—Ä–∞ —Ç–∞–º –Ω–∞—Å—Ç—É–ø–∏–ª–æ –∑–∞–≤—Ç—Ä–∞.",
    "‚òÅÔ∏è –ñ–∏–≤–æ–µ –æ–±–ª–∞–∫–æ –≥–∞–∑–∞ –Ω–∞—á–∞–ª–æ –∏–∑—É—á–∞—Ç—å –≤–∞—à—É –º–∞—Ç–µ–º–∞—Ç–∏–∫—É.",
    "üëÅ –í —Ü–µ–Ω—Ç—Ä–µ –≥–∞–ª–∞–∫—Ç–∏–∫–∏ –æ—Ç–∫—Ä—ã–ª–æ—Å—å –û–∫–æ –ë–µ–∑–¥–Ω—ã. –û–Ω–æ —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ –≤–∞—Å.",
    "üß∏ –ù–∞–π–¥–µ–Ω–∞ –ø–ª–∞–Ω–µ—Ç–∞, —Å–æ—Å—Ç–æ—è—â–∞—è —Ü–µ–ª–∏–∫–æ–º –∏–∑ –º—è–≥–∫–æ–≥–æ –æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–æ–≥–æ –ø—É—Ö–∞.",
    "üç≠ –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ —ç—Ç–æ–π –ª—É–Ω—ã –ø–∞—Ö–Ω–µ—Ç –∫–∞—Ä–∞–º–µ–ª—å—é –∏–∑-–∑–∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ö–∏–º–∏–∫–∞—Ç–æ–≤.",
    "üóø –ì–∏–≥–∞–Ω—Ç—Å–∫–∏–µ —Å—Ç–∞—Ç—É–∏ –Ω–∞ –±–µ–∑–∂–∏–∑–Ω–µ–Ω–Ω–æ–º –∫–∞–º–Ω–µ —Å–º–æ—Ç—Ä—è—Ç –≤ —Å—Ç–æ—Ä–æ–Ω—É –ó–µ–º–ª–∏.",
    
    # --- –¢–†–ò–£–ú–§ –¢–í–û–†–¶–ê ---
    "üëë –í–∞—à–µ –∏–º—è –≤—ã—Å–µ—á–µ–Ω–æ –Ω–∞ –∫–æ–ª—å—Ü–∞—Ö –∫–∞–∂–¥–æ–π –ø–ª–∞–Ω–µ—Ç—ã –≤ —ç—Ç–æ–π —Å–∏—Å—Ç–µ–º–µ.",
    "üèó –ó–∞–≤–µ—Ä—à–µ–Ω–æ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –º–µ–∂–≥–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–æ—Å—Ç–∞. –ú–∏—Ä—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã.",
    "üé≠ –í—ã —Å–æ–∑–¥–∞–ª–∏ —Ä–∞—Å—É, –∫–æ—Ç–æ—Ä–∞—è —Å—á–∏—Ç–∞–µ—Ç –≤–∞—Å –±–æ–≥–æ–º –∏ –≤–æ–∑–≤–æ–¥–∏—Ç —Ö—Ä–∞–º—ã.",
    "üåä –û–∫–µ–∞–Ω –Ω–∞ –ø–ª–∞–Ω–µ—Ç–µ —Å—Ç–∞–ª —Ä–∞–∑—É–º–Ω—ã–º –∏ –ø–æ–ø—Ä–æ—Å–∏–ª –≤–∞—Å –æ —Ä–∞–∑–≥–æ–≤–æ—Ä–µ.",
    "üéá –í–µ–ª–∏–∫–∏–π –ü–∞—Ä–∞–¥ –ü–ª–∞–Ω–µ—Ç –Ω–∞—á–∞–ª—Å—è! –≠–Ω–µ—Ä–≥–∏—è —Å–æ–∑–∏–¥–∞–Ω–∏—è –Ω–∞ –ø–∏–∫–µ.",
    "üõ° –í—ã —Å–æ–∑–¥–∞–ª–∏ –ø–ª–∞–Ω–µ—Ç–∞—Ä–Ω—ã–π —â–∏—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ø—Ä–æ–±—å–µ—Ç –¥–∞–∂–µ —Å–≤–µ—Ä—Ö–Ω–æ–≤–∞—è.",
    "üîã –≠–Ω–µ—Ä–≥–∏—è –≤–∞–∫—É—É–º–∞ —Ç–µ–ø–µ—Ä—å —Ç–µ—á–µ—Ç —á–µ—Ä–µ–∑ –≤–∞—à–∏ –ø–∞–ª—å—Ü—ã. –í—ã –≤—Å–µ—Å–∏–ª—å–Ω—ã!",
    "üåà –í –∫–æ—Å–º–æ—Å–µ —Ä–∞—Å—Ü–≤–µ–ª–∏ '–∑–≤–µ–∑–¥–Ω—ã–µ —Ü–≤–µ—Ç—ã' —Ä–∞–∑–º–µ—Ä–æ–º —Å –∫–æ–Ω—Ç–∏–Ω–µ–Ω—Ç.",
    "üïä –í–æ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º–µ –Ω–∞—Å—Ç—É–ø–∏–ª–∞ —ç–ø–æ—Ö–∞ –ê–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –ú–∏—Ä–∞.",
    "üíé –ê–ª–º–∞–∑–Ω—ã–π –¥–æ–∂–¥—å –ø—Ä–æ—à–µ–ª –Ω–∞ –ø–ª–∞–Ω–µ—Ç–µ, —Å–¥–µ–ª–∞–≤ –µ–µ —Å–∞–º–æ–π –¥–æ—Ä–æ–≥–æ–π –≤ –º–∏—Ä–µ.",
    "üåë –õ—É–Ω–∞ –≤–Ω–µ–∑–∞–ø–Ω–æ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∞—Å—å –≤ –æ–≥—Ä–æ–º–Ω—ã–π –≥–ª–∞–∑ –∏ –ø–æ–¥–º–∏–≥–Ω—É–ª–∞ –≤–∞–º.",
    "üåå –í—ã —Å–æ–∑–¥–∞–ª–∏ –Ω–æ–≤—É—é –≥–∞–ª–∞–∫—Ç–∏–∫—É –∏–∑ –æ—Å—Ç–∞—Ç–∫–æ–≤ —Å—Ç–∞—Ä–æ–π. –†–µ—Ü–∏—Ä–∫—É–ª—è—Ü–∏—è!",
    "üé∑ –ó–≤—É–∫–∏ –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ –¥–∂–∞–∑–∞ —Ä–∞–∑–Ω–æ—Å—è—Ç—Å—è –ø–æ –≤—Å–µ–º —Ä–∞–¥–∏–æ—á–∞—Å—Ç–æ—Ç–∞–º —Å–∏—Å—Ç–µ–º—ã.",
    "üõë –í—Ä–µ–º—è –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å. –í—ã ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π, –∫—Ç–æ –º–æ–∂–µ—Ç –¥–≤–∏–≥–∞—Ç—å—Å—è."
]

# --- –ö–õ–ê–í–ò–ê–¢–£–†–´ ---

def main_kb(user_id):
    builder = ReplyKeyboardBuilder()
    builder.button(text="üöÄ –°–æ–∑–¥–∞—Ç—å –ú–∏—Ä")
    builder.button(text="üìä –ú–æ—è –í—Å–µ–ª–µ–Ω–Ω–∞—è")
    builder.button(text="üí° –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏–¥–µ—é")
    builder.button(text="üéÅ –ü–æ–º–æ—â—å")
    
    if user_id == ADMIN_ID:
        builder.button(text="üõ° –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨")
    
    builder.adjust(2)
    return builder.as_markup(resize_keyboard=True)

# --- –•–ï–ù–î–õ–ï–†–´ ---

@dp.message(Command("start"))
async def start_cmd(message: types.Message):
    data = load_data()
    user_id = str(message.from_user.id)
    username = message.from_user.first_name

    if user_id not in data["players"]:
        data["players"][user_id] = {
            "name": username,
            "credits": 100,
            "level": 1,
            "worlds": 0,
            "history": []
        }
    
    save_data(data)
    
    welcome_text = (
        f"üåå –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é, {username}!!!\n\n"
        f"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —Å–∏–º—É–ª—è—Ç–æ—Ä –¢–≤–æ—Ä—Ü–∞ –í—Å–µ–ª–µ–Ω–Ω–æ–π. "
        f"–í–∞—à —Ç–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: {data['players'][user_id]['credits']} –∫–æ—Å–º–∏—á–µ—Å–∫–∏—Ö –∫—Ä–µ–¥–∏—Ç–æ–≤.\n"
        f"–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –Ω–∏–∂–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —ç–∫—Å–ø–∞–Ω—Å–∏—é!"
    )
    await message.answer(welcome_text, reply_markup=main_kb(message.from_user.id))

@dp.message(F.text == "üöÄ –°–æ–∑–¥–∞—Ç—å –ú–∏—Ä")
async def create_world(message: types.Message):
    data = load_data()
    user_id = str(message.from_user.id)
    
    if data["players"][user_id]["credits"] < 50:
        await message.answer("‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–µ–¥–∏—Ç–æ–≤! –ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 50.")
        return

    data["players"][user_id]["credits"] -= 50
    data["players"][user_id]["worlds"] += 1
    phrase = random.choice(SPACE_PHRASES)
    data["players"][user_id]["history"].append(f"–°–æ–∑–¥–∞–Ω –º–∏—Ä: {phrase[:20]}...")
    
    save_data(data)
    
    await message.answer(f"üõ† **–ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ–∑–∏–¥–∞–Ω–∏—è...**\n\n{phrase}\n\n‚úÖ –ú–∏—Ä —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω! –ë–∞–ª–∞–Ω—Å: {data['players'][user_id]['credits']}")

@dp.message(F.text == "üìä –ú–æ—è –í—Å–µ–ª–µ–Ω–Ω–∞—è")
async def stats(message: types.Message):
    data = load_data()
    user_id = str(message.from_user.id)
    p = data["players"].get(user_id)
    
    res = (
        f"üõ∞ **–ë–æ—Ä—Ç–æ–≤–æ–π –∂—É—Ä–Ω–∞–ª: {p['name']}**\n"
        f"‚ïº‚ïº‚ïº‚ïº‚ïº‚ïº‚ïº‚ïº‚ïº‚ïº‚ïº‚ïº‚ïº‚ïº‚ïº\n"
        f"üß¨ –£—Ä–æ–≤–µ–Ω—å —Ä–∞–∑–≤–∏—Ç–∏—è: {p['level']}\n"
        f"üí∞ –ö—Ä–µ–¥–∏—Ç—ã: {p['credits']}\n"
        f"ü™ê –°–æ–∑–¥–∞–Ω–æ –º–∏—Ä–æ–≤: {p['worlds']}\n"
        f"üèÜ –°—Ç–∞—Ç—É—Å: { '–ù–æ–≤–∏—á–æ–∫' if p['level'] < 5 else '–í–ª–∞–¥—ã–∫–∞ –ü—É—Å—Ç–æ—Ç—ã' }"
    )
    await message.answer(res)

@dp.message(F.text == "üí° –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏–¥–µ—é")
async def suggest_idea(message: types.Message):
    await message.answer("üìù –ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à—É –∏–¥–µ—é —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º (–Ω–∞—á–Ω–∏—Ç–µ —Å–æ —Å–ª–æ–≤–∞ '–ò–¥–µ—è:'). –Ø –ø–µ—Ä–µ–¥–∞–º –µ—ë –°–æ–∑–¥–∞—Ç–µ–ª—è–º!")

@dp.message(F.text.startswith("–ò–¥–µ—è:"))
async def save_suggestion(message: types.Message):
    data = load_data()
    suggestion = {
        "user": message.from_user.full_name,
        "text": message.text.replace("–ò–¥–µ—è:", "").strip()
    }
    data["suggestions"].append(suggestion)
    save_data(data)
    await message.answer("üì° –°–∏–≥–Ω–∞–ª –ø–æ–ª—É—á–µ–Ω! –í–∞—à–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –∞—Ä—Ö–∏–≤–∞—Ö —à—Ç–∞–±–∞.")

# --- –ê–î–ú–ò–ù-–§–£–ù–ö–¶–ò–ò ---

@dp.message(F.text == "üõ° –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨")
async def admin_panel(message: types.Message):
    if message.from_user.id != ADMIN_ID:
        return

    data = load_data()
    total_players = len(data["players"])
    total_sug = len(data["suggestions"])
    
    builder = InlineKeyboardBuilder()
    builder.button(text="üë• –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤", callback_data="list_players")
    builder.button(text="üì© –ß–∏—Ç–∞—Ç—å –∏–¥–µ–∏", callback_data="read_ideas")
    builder.adjust(1)
    
    await message.answer(
        f"‚öôÔ∏è **–¶–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**\n\n–í—Å–µ–≥–æ –∏–≥—Ä–æ–∫–æ–≤: {total_players}\n–ù–æ–≤—ã—Ö –∏–¥–µ–π: {total_sug}",
        reply_markup=builder.as_markup()
    )

@dp.callback_query(F.data == "read_ideas")
async def show_ideas(callback: types.CallbackQuery):
    data = load_data()
    if not data["suggestions"]:
        await callback.message.answer("–ü–æ–∫–∞ –∏–¥–µ–π –Ω–µ—Ç.")
        return
        
    text = "üì• **–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏–≥—Ä–æ–∫–æ–≤:**\n\n"
    for i, s in enumerate(data["suggestions"][-5:]): # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5
        text += f"{i+1}. {s['user']}: {s['text']}\n\n"
    await callback.message.answer(text)

@dp.message(Command("gift"))
async def gift_credits(message: types.Message):
    if message.from_user.id != ADMIN_ID: return
    
    try:
        args = message.text.split()
        target_id = args[1]
        amount = int(args[2])
        
        data = load_data()
        if target_id in data["players"]:
            data["players"][target_id]["credits"] += amount
            save_data(data)
            await message.answer(f"‚úÖ –ò–≥—Ä–æ–∫—É {target_id} –Ω–∞—á–∏—Å–ª–µ–Ω–æ {amount} –∫—Ä–µ–¥–∏—Ç–æ–≤!")
            await bot.send_message(target_id, f"üéÅ –ê–¥–º–∏–Ω –ø—Ä–∏—Å–ª–∞–ª –≤–∞–º –ø–æ–¥–∞—Ä–æ–∫: {amount} –∫—Ä–µ–¥–∏—Ç–æ–≤!")
    except:
        await message.answer("–û—à–∏–±–∫–∞! –§–æ—Ä–º–∞—Ç: /gift ID –°–£–ú–ú–ê")

async def main():
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
